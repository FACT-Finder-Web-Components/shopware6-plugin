"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["omikron_shopware6-factfinder_src_Resources_app_storefront_src_plugin_tracking_plugin_js"],{404:(e,t,r)=>{r.r(t),r.d(t,{default:()=>a});var n=r(568),i=r(49);class a extends n.Z{init(){this.registerEvents()}registerEvents(){window.PluginManager.getPluginInstances("AddToCart").forEach(e=>e.$emitter.subscribe("beforeFormSubmit",this.trackAddToCart.bind(this)))}getQuantity(e){if("count_as_one"===ffTrackingSettings.addToCart.count)return 1;try{let t=i.Z.querySelector(e,'[name$="[quantity]"]');return parseInt(t.value)}catch(e){return 1}}async trackAddToCart(e){let t=i.Z.querySelector(e.target,'[name="product-number"]'),r=this.getQuantity(e.target);t&&new Promise(e=>{void 0!==window.factfinder?e(window.factfinder):document.addEventListener("ffCoreReady",t=>e(t.factfinder))}).then(e=>{let n=e.communication.Util.trackingHelper;e.communication.EventAggregator.addFFEvent({type:"getRecords",recordId:t.value,idType:"productNumber",success:t=>{let[i]=t,a=e.communication.fieldRoles;e.communication.Tracking.cart({id:(e=>{let{record:t}=e;return t[a.trackingProductNumber]||t[a.productNumber]})(i),masterId:(e=>{let{record:t}=e;return t[a.masterArticleNumber]||t[a.masterId]})(i),price:n.getPrice(i),title:n.getTitle(i),count:r,userId:e.communication.globalCommunicationParameter.userId})}})})}}}}]);
{% sw_extends '@Parent/storefront/base.html.twig' %}

{% block base_body_inner %}
  {% set factfinder_config = page.extensions.factfinder.all.communication %}
  <ff-communication url="{{ factfinder_config.url }}" version="{{ factfinder_config.version }}" api="{{ factfinder_config.api }}"
                    channel="{{ factfinder_config.channel }}"
                    use-url-parameters="true" default-query="shirt" search-immediate>
  </ff-communication>
  {{ parent() }}
{% endblock %}

{% block base_body_script %}
  {% block base_script_factfinder_search_redirect %}
    <script>
      document.addEventListener('before-search', function (event) {
        if (['productDetail', 'getRecords'].lastIndexOf(event.detail.type) === -1) {
          event.preventDefault();
          window.location = '{{ path('frontend.factfinder.result') }}' + factfinder.common.dictToParameterString(event.detail);
        }
      });
    </script>
  {% endblock %}

  {{ parent() }}
{% endblock %}
